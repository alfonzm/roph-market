<template>
	<div class="ro-item-stall-search">
		<item-search placeholder="What are you looking for? (e.g. Marc Card, +7 Occult Wand)" @onSelectSearchResult="searchStallByRoItem" v-model="query"></item-search>
		<div>
			<span v-if="loading">Loading stalls...</span>
			<ul v-else>
				<li v-for="(stall, index) in results">
					<a :href="'/stalls/' + stall.id">{{ stall.name }}</a>
				</li>
			</ul>
		</div>
	</div>
</template>

<script>
import ItemSearch from './presentational/ItemSearch.vue'

export default {
	data() {
		return {
			query: '',
			results: [],
			loading: false
		}
	},
	components: {
		'item-search': ItemSearch
	},
	methods: {
		searchStallByRoItem(roItem) {
			this.loading = true
			axios.get('/api/v1/stalls/search', {
				params: {
					i: roItem.id
				}
			}).then(response => {
				this.loading = false
				this.results = response.data
			});
		}
	}
}
</script>